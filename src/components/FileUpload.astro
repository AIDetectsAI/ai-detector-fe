---
export interface Props {
  accept?: string;
  multiple?: boolean;
  title?: string;
  description?: string;
  buttonText?: string;
  onclick?: string;
}

const { 
  accept = "*",
  multiple = false,
  title = "Upload file for analysis",
  description = "Drop file here or click to select",
  buttonText = "Choose File",
  onclick = "alert('WIP')"
} = Astro.props;
---

<div class="bg-white rounded-lg border-2 border-dashed border-gray-300 p-8">
  <h2 class="text-xl font-semibold text-gray-800 mb-6">{title}</h2>

  <div class="flex flex-col items-center justify-center py-12 px-6 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400 transition-colors duration-200">
    <div class="mb-4">
      <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
      </svg>
    </div>

    <p class="text-gray-600 text-center mb-4">
      {description}
    </p>

    <input 
      type="file" 
      id="fileInput" 
      class="hidden" 
      accept={accept}
      multiple={multiple}
    />

    <button 
      type="button"
      class="cursor-pointer bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition duration-200 ease-in-out"
      onclick={`event.stopPropagation(); ${onclick}`}
    >
      {buttonText}
    </button>
  </div>

  <slot />
</div>

<script>
  const dropZone = document.querySelector('.bg-gray-50');
  const fileInput = document.getElementById('fileInput') as HTMLInputElement;

  if (dropZone && fileInput) {
    dropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropZone.classList.add('border-blue-400', 'bg-blue-50');
    });

    dropZone.addEventListener('dragleave', () => {
      dropZone.classList.remove('border-blue-400', 'bg-blue-50');
    });

    dropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropZone.classList.remove('border-blue-400', 'bg-blue-50');
      alert('WIP');
    });

    dropZone.addEventListener('click', () => {
      alert('WIP');
    });

    fileInput.addEventListener('change', () => {
      alert('WIP');
    });
  }
</script>
